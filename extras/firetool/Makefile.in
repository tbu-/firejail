all: src firetool.1

datarootdir=@datarootdir@
PREFIX=@prefix@
prefix=@prefix@
VERSION=@PACKAGE_VERSION@
NAME=@PACKAGE_NAME@
PACKAGE_TARNAME=@PACKAGE_TARNAME@
DOCDIR=@docdir@

.PHONY: src
src:
	$(MAKE) -C $@ $(MFLAGS)


firetool.1: src/man/firetool.txt
	./mkman.sh $(VERSION) src/man/firetool.txt firetool.1

clean:;rm -f build/*; rm -f *.1 *.1.gz; make -C src clean

distclean: clean
	rm -f `find src/firetool -name Makefile`
	rm -f firetool_config.h Makefile config.status config.log firetool_prefix.h
	rm -f  src/firetool/config.log src/firetool/config.status #fedora fix
	rm -fr autom4te.cache
	rm -f sanitizer.sh

	
install: all
	cd build; strip *; cd ..
	mkdir -p $(DESTDIR)/$(PREFIX)/bin
	mkdir -p $(DESTDIR)/$(PREFIX)/share/applications
	mkdir -p $(DESTDIR)/$(PREFIX)/share/pixmaps
	mkdir -p $(DESTDIR)/$(DOCDIR)
	mkdir -p $(DESTDIR)/$(PREFIX)/share/man/man1
	install -c -m 0755 build/firetool $(DESTDIR)/$(PREFIX)/bin/.
	install -c -m 0644 src/firetool/firetool.desktop $(DESTDIR)/$(PREFIX)/share/applications/.
	install -c -m 0644 src/firetool/resources/firetool.png $(DESTDIR)/$(PREFIX)/share/pixmaps/firetool.png
	install -c -m 0644 COPYING $(DESTDIR)/$(DOCDIR)/.
	install -c -m 0644 README $(DESTDIR)/$(DOCDIR)/.
	install -c -m 0644 RELNOTES $(DESTDIR)/$(DOCDIR)/.
	rm -f firetool.1.gz
	gzip -9 firetool.1
	install -c -m 0644 firetool.1.gz $(DESTDIR)/$(PREFIX)/share/man/man1/.

uninstall:;
	rm -f $(DESTDIR)/$(PREFIX)/bin/firetool
	rm -f $(DESTDIR)/$(PREFIX)/share/pixmaps/firetool.png
	rm -f $(DESTDIR)/$(PREFIX)/share/applications/firetool.desktop
	rm -fr $(DESTDIR)/$(PREFIX)/share/doc/firetool
	rm -fr $(DESTDIR)/$(PREFIX)/share/man/man1/firetool.1*

#
#dist: distclean
#	./mkdist.sh $(NAME) $(VERSION)
#
#deb: dist
#	./mkdeb.sh $(NAME) $(VERSION)
#
#	
#########	